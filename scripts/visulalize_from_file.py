import os
import matplotlib.pyplot as plt
import pandas as pd
import seaborn as sns
import pickle


def plot_scatter(dict_distanze, title, xlabel, ylabel, figsize=(10, 10)):
    # Converti il dizionario in un DataFrame e resetta l'indice
    df = pd.DataFrame.from_dict(dict_distanze, orient='index', columns=['distanza', 'h_index']).reset_index()

    # Rinomina la colonna dell'indice
    df = df.rename(columns={'index': 'nome'})

    # Rimuovi la parte della stringa dopo il punto
    df['nome'] = df['nome'].str.split('.').str[0]

    # Crea lo scatterplot con un colore per ogni punto e una legenda
    scatter = sns.scatterplot(data=df, x='distanza', y='h_index', hue='nome', palette='viridis')

    # Imposta il titolo e le etichette degli assi
    plt.title(title)
    plt.xlabel(xlabel)
    plt.ylabel(ylabel)

    # Mostra il grafico
    plt.show()


if __name__ == "__main__":
    path_to_pickle = os.path.join(os.path.dirname(__file__),
                                  '..', 'data', 'pkl', 'dict_distanze.pickle', )

    with open(path_to_pickle, 'rb') as handle:
        dict_distanze = pickle.load(handle)

    plot_scatter(dict_distanze, 'Distanza media tra i documenti', 'Distanza media', 'h-index')
