# library for E2-Index

import numpy as np
import pandas as pd

import requests


# write a function to retrieve the data from SCOPUS
# input is author_id
# output is a list of all the papers of that author in pandas dataframe format
def get_papers_by_id(author_id):
    # TODO REMOVE KEY BEFORE COMMITTING
    api_key = "TODO"

    base_url = "https://api.elsevier.com/content/search/scopus"
    headers = {
        "X-ELS-APIKey": api_key,
        "Accept": "application/json"
    }
    params = {
        "query": f"AU-ID({author_id})",
        "field": "title,publicationName,coverDate,DOI"
    }

    response = requests.get(base_url, headers=headers, params=params)

    if response.status_code == 200:
        papers_raw = response.json()

        # clean

        # convert to pandas dataframe

        a = 11
        # Process JSON data to DataFrame
        # This depends on the structure of the response
        # df = pd.DataFrame(...)  # Replace with actual data processing code
        # return df
    else:
        print("Failed to retrieve data:", response.status_code)
        # return pd.DataFrame()

    # get all the papers of the author
    # papers = process_json(papers_raw)

    # get the data of each paper
    # data = []
    # for paper in papers:
    #     data.append(get_paper_data(paper))

    return papers_raw
