import os
import pickle

import sqlite3
import pandas as pd




if __name__ == '__main__':

    # Connect to the database
    db_path = os.path.join(os.path.dirname(__file__),
                           '..', 'data', 'db', 'e2index.db')

    conn = sqlite3.connect(db_path)

    # Read SQL tables into DataFrames
    # df_author = pd.read_sql('SELECT * FROM Author', conn)
    df_paper = pd.read_sql('SELECT * FROM Paper', conn)

    # df_author_paper = pd.read_sql('SELECT * FROM Author_Paper', conn)

    df_paper['digital_image'] = df_paper['digital_image_pickled'].apply(pickle.loads)


    # TODO 1) SELECT all papers of the given author using many-to-many table AuthorPaper
    # IN: author_id
    # select * from AuthorPaper where Authorid = 1)

    # TODO 2) for each paper, load the digital image from the Paper table

    # TODO calculations here

    # Close the connection
    conn.close()
