# %%
from utils.functions_needed import *
import os 
import pickle


# %%import os
 # or 'iuss pavia'

# Get a list of all csv files in the current directory
def main(which_dir = 'imt'):


    csv_files = [f for f in os.listdir(which_dir) if f.endswith('.csv')]

    distanze = []
    h_indexes = []
    for file in csv_files:
        # Open the csv file
        database = open_csv('/'.join([which_dir, file]))

        # Clean the data
        clean_data = clean_csv(['Abstract', 'Cited by'], database)

        # Calculate the vectors
        docs = calculate_vectors(clean_data['Abstract'])

        # Calculate the cosine distance
        distanze.append(calculate_cosine_distance(docs))
        h_indexes.append(h_index(clean_data['Cited by']))

        dict_distanze = dict(zip(csv_files, zip(distanze, h_indexes)))

    return dict_distanze

# %%
if __name__ == "__main__":
    dict_distanze = main()
# %%

# %%

# save everything in a pickle file

with open('dict_distanze.pickle', 'wb') as handle:
    pickle.dump(dict_distanze, handle, protocol=pickle.HIGHEST_PROTOCOL)
# %%

# for the network I would need to know how many times each co-author of emiliano ricciardi
# let's say has cited all the other authors present in the network of co-authors of emiliano ricciardi
# so that the weight of the edge between emiliano ricciardi and the other author is the number of times that author has cited emiliano ricciardi
# and then I would need to do the same for all the other authors in the network only for the authors that are in the network of emiliano
# Do i consider just co-authors or all the authors that emiliano has cited or have cited emiliano? 



## anothe possibility is to use all the keywords for each co-author (then use the number of shared papers as weight for the edge)
## and use these keywords as a measure for diversity in the network of co-authors of emiliano ricciardi
## see whether the diversity of the network of co-authors of emiliano ricciardi is higher than the diversity of the network of co-authors of the other authors
## DIMMI CON CHI VAI E TI DIRÒ CHI SEI indice
# DCCVTDCS


## numero di paper su stesso topic mi dà una sorta di indice di depth
## densità + disrputiveness (depth)  --- correlazione densità e depth 

## l'idea è un network di coauthoring interno all'imt tra professori e vedere su quali
# tipi di argomenti ci sono più collaborazioni e quali sono i professori più centrali
 