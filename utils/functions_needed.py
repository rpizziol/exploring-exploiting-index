

###
import pandas as pd
import spacy
import numpy as np
nlp = spacy.load('en_core_web_md') 

def open_csv(filename):
    df = pd.read_csv(filename)
    return df



def clean_csv(columns_to_keep, df):
    
    df = df.drop(~columns_to_keep, axis=1)
    return df
    


def calculate_vectors(abstract_column):
    for i in range(len(abstract_column)):
        doc = nlp(abstract_column[i])
        abstract_column[i] = doc.vector
    
    return doc


def calculate_cosine_similarity(doc, which_method = 'average'):
    similarity = [doc.similarity(doc[i], doc[i+1]) for i in range(len(doc)-1) ]   
    return np.mean(similarity, axis=0)
